---
/**
 * ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸
 * 
 * å…¨ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚»ãƒªãƒ•ã‚’è¡¨ç¤º
 * ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—: 20ä»¶ã€ãƒ¢ãƒã‚¤ãƒ«: 15ä»¶
 */
import MainLayout from '../layouts/MainLayout.astro';
import Breadcrumb from '../components/Breadcrumb.astro';
import SearchBar from '../components/SearchBar.astro';
import SortMenu from '../components/SortMenu.astro';
import categoriesData from '../data/categories.json';
import type { Serifu, Category, CategoriesData } from '../types';

const data = categoriesData as CategoriesData;

// å…¨ã‚»ãƒªãƒ•ã‚’ã‚«ãƒ†ã‚´ãƒªãƒ¼æƒ…å ±ä»˜ãã§å–å¾—
const allSerifu: Array<Serifu & { category: string }> = [];

data.categories.forEach((category: Category) => {
  category.serifu.forEach((serifu: Serifu) => {
    allSerifu.push({
      ...serifu,
      category: category.id,
    });
  });
});

const title = 'ã“ã¨ã°ç®± - é¢ç™½ã„ã‚»ãƒªãƒ•é›†';
const description = 'ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã‚„é…ä¿¡ã§ä½¿ãˆã‚‹é¢ç™½ã„ã‚»ãƒªãƒ•é›†ã€‚ç½°ã‚²ãƒ¼ãƒ ã€å‘Šç™½ã€é…ä¿¡ã€å¨äºŒç—…ãªã©ã€æ§˜ã€…ãªã‚·ãƒ¼ãƒ³ã§ä½¿ãˆã‚‹ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªã‚»ãƒªãƒ•ã‚’æ¢ã›ã¾ã™ã€‚';
---

<MainLayout title={title} description={description}>
  <!-- ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆ -->
  <Breadcrumb items={[{ label: 'ãƒ›ãƒ¼ãƒ ', icon: 'ğŸ ' }]} />
  
  <!-- ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ« -->
  <div class="mb-8">
    <h1 class="text-4xl font-bold mb-3 text-gray-800">
      <span class="text-4xl">ğŸ“¦</span>
      ã“ã¨ã°ç®±
    </h1>
    <p class="text-gray-600">
      å…¨ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«è¡¨ç¤ºä¸­
    </p>
  </div>
  
  <!-- æ¤œç´¢ãƒãƒ¼ & ã‚½ãƒ¼ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
  <div class="flex flex-col md:flex-row gap-4 mb-6">
    <div class="flex-1">
      <SearchBar placeholder="ã‚»ãƒªãƒ•ã‚’æ¤œç´¢..." />
    </div>
    <SortMenu showFavoriteSort={false} />
  </div>
  
  <!-- ã‚»ãƒªãƒ•ã‚°ãƒªãƒƒãƒ‰ -->
  <div id="serifu-list" class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <!-- JavaScriptã§å‹•çš„ã«æç”» -->
  </div>
</MainLayout>

<script>
  /**
   * ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã®åˆæœŸåŒ–
   */
  import { initializeHomePage } from '../scripts/serifuCard';
  import type { Serifu } from '../types';
  
  // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰æ¸¡ã•ã‚ŒãŸå…¨ã‚»ãƒªãƒ•ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
  const allSerifuData = document.getElementById('all-serifu-data');
  if (allSerifuData) {
    const allSerifu = JSON.parse(allSerifuData.textContent || '[]') as Array<Serifu & { category: string }>;
    
    // ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸åˆæœŸåŒ–ï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ: ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—20ä»¶ã€ãƒ¢ãƒã‚¤ãƒ«15ä»¶ï¼‰
    initializeHomePage(allSerifu);
  }
</script>

<!-- å…¨ã‚»ãƒªãƒ•ãƒ‡ãƒ¼ã‚¿ã‚’JSONã§åŸ‹ã‚è¾¼ã¿ï¼ˆJavaScriptã‹ã‚‰å‚ç…§ï¼‰ -->
<script type="application/json" id="all-serifu-data" set:html={JSON.stringify(allSerifu)} />