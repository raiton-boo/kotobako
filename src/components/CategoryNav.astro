---
/**
 * ã‚«ãƒ†ã‚´ãƒªãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
 * 
 * ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«ã‚«ãƒ†ã‚´ãƒªãƒ¼ä¸€è¦§ã¨ãŠæ°—ã«å…¥ã‚Šãƒªãƒ³ã‚¯ã‚’è¡¨ç¤º
 * ãƒãƒƒã‚¸ã®è‡ªå‹•æ›´æ–°æ©Ÿèƒ½ä»˜ã
 */
import categoriesData from '../data/categories.json';

const currentPath = Astro.url.pathname;

interface Category {
  id: string;
  name: string;
  icon: string;
  description: string;
}

interface CategoriesData {
  categories: Category[];
}

const data = categoriesData as CategoriesData;
const categories = data.categories;

function isActive(path: string): boolean {
  return currentPath === path || currentPath === `${path}/`;
}
---

<aside class="w-64 shrink-0 hidden lg:block">
  <nav class="sticky top-8 bg-white rounded-2xl shadow-md p-6">
    <h2 class="text-lg font-bold mb-4 text-gray-800">ã‚«ãƒ†ã‚´ãƒªãƒ¼</h2>
    <ul class="space-y-2">
      <li>
        <a
          href="/kotobako"
          class={`flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 ${
            isActive('/kotobako')
              ? 'bg-purple-400 text-white font-bold shadow-md'
              : 'text-gray-700 hover:bg-gray-100'
          }`}
        >
          <span class="text-xl">ğŸ </span>
          <span>ãƒ›ãƒ¼ãƒ </span>
        </a>
      </li>
      
      {categories.map((category) => (
        <li>
          <a
            href={`/kotobako/category/${category.id}`}
            class={`flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 ${
              isActive(`/kotobako/category/${category.id}`)
                ? 'bg-purple-400 text-white font-bold shadow-md'
                : 'text-gray-700 hover:bg-gray-100'
            }`}
          >
            <span class="text-xl">{category.icon}</span>
            <span>{category.name}</span>
          </a>
        </li>
      ))}
      
      <li class="pt-4 border-t border-gray-200">
        <a
          href="/kotobako/favorites"
          class={`flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 relative ${
            isActive('/kotobako/favorites')
              ? 'bg-purple-400 text-white font-bold shadow-md'
              : 'text-gray-700 hover:bg-gray-100'
          }`}
        >
          <span class="text-xl">ğŸ’–</span>
          <span>ãŠæ°—ã«å…¥ã‚Š</span>
          <span 
            class="favorite-badge absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center"
            style="display: none;"
          >
            0
          </span>
        </a>
      </li>
    </ul>
  </nav>
</aside>

<script>
  /**
   * ãŠæ°—ã«å…¥ã‚Šãƒãƒƒã‚¸ã®åˆæœŸåŒ–
   * ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒãƒƒã‚¸ã‚’æ›´æ–°
   */
  import { initFavoritesWatcher } from '../utils/favorites';
  
  // ãŠæ°—ã«å…¥ã‚Šç›£è¦–ã‚’åˆæœŸåŒ–ï¼ˆãƒãƒƒã‚¸è‡ªå‹•æ›´æ–°ï¼‰
  initFavoritesWatcher();
</script>